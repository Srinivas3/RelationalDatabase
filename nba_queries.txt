CREATE TABLE PLAYERS(ID string, FIRSTNAME string, LASTNAME string, FIRSTSEASON int, LASTSEASON int, WEIGHT int, BIRTHDATE date);

SELECT FIRSTNAME, LASTNAME, WEIGHT, BIRTHDATE 
FROM PLAYERS 
WHERE WEIGHT>200;

SELECT FIRSTSEASON, COUNT(ID) 
FROM PLAYERS 
GROUP BY FIRSTSEASON;

SELECT FIRSTNAME, LASTNAME, FIRSTSEASON, LASTSEASON 
FROM PLAYERS 
WHERE LASTSEASON-FIRSTSEASON>5;

SELECT EXPERIENCE, COUNT(*) 
FROM (
  SELECT ID, FIRSTNAME, LASTNAME, 
         (LASTSEASON-FIRSTSEASON) AS EXPERIENCE 
  FROM PLAYERS
) 
GROUP BY EXPERIENCE;

SELECT P1_FIRSTNAME, P1_LASTNAME, 
       P2_FIRSTNAME, P2_LASTNAME 
FROM (
  SELECT P1.FIRSTNAME AS P1_FIRSTNAME, P1.LASTNAME AS P1_LASTNAME,
         P2.FIRSTNAME AS P2_FIRSTNAME, P2.LASTNAME AS P2_LASTNAME,
         P1.FIRSTSEASON AS P1_FIRSTSEASON, P1.LASTSEASON AS P1_LASTSEASON,
         P2.FIRSTSEASON AS P2_FIRSTSEASON, P2.LASTSEASON AS P2_LASTSEASON
    FROM PLAYERS P1, PLAYERS P2 
  WHERE P1.ID<>P2.ID
  ) SUB_Q 
WHERE P1_FIRSTSEASON<P2_FIRSTSEASON 
  AND P1_LASTSEASON>P2_LASTSEASON;

SELECT P1_FIRSTNAME, P1_LASTNAME, 
       P2_FIRSTNAME, P2_LASTNAME 
FROM (
  SELECT P1.FIRSTNAME AS P1_FIRSTNAME, P1.LASTNAME AS P1_LASTNAME,
         P2.FIRSTNAME AS P2_FIRSTNAME, P2.LASTNAME AS P2_LASTNAME,
         P1.FIRSTSEASON AS P1_FIRSTSEASON, P1.LASTSEASON AS P1_LASTSEASON,
         P2.FIRSTSEASON AS P2_FIRSTSEASON, P2.LASTSEASON AS P2_LASTSEASON
    FROM 
      (SELECT ID,FIRSTNAME,LASTNAME,FIRSTSEASON,LASTSEASON FROM PLAYERS ORDER BY ID LIMIT 1000) P1,
      (SELECT ID,FIRSTNAME,LASTNAME,FIRSTSEASON,LASTSEASON FROM PLAYERS ORDER BY ID LIMIT 1000) P2
  WHERE P1.ID<>P2.ID
  ) SUB_Q 
WHERE P1_FIRSTSEASON<P2_FIRSTSEASON 
  AND P1_LASTSEASON>P2_LASTSEASON;



SELECT P1_FIRSTNAME, P1_LASTNAME, 
       P2_FIRSTNAME, P2_LASTNAME 
FROM (
  SELECT P1.FIRSTNAME AS P1_FIRSTNAME, P1.LASTNAME AS P1_LASTNAME,
         P2.FIRSTNAME AS P2_FIRSTNAME, P2.LASTNAME AS P2_LASTNAME,
         P1.FIRSTSEASON AS P1_FIRSTSEASON, P1.LASTSEASON AS P1_LASTSEASON,
         P2.FIRSTSEASON AS P2_FIRSTSEASON, P2.LASTSEASON AS P2_LASTSEASON
    FROM 
      (SELECT ID,FIRSTNAME,LASTNAME,FIRSTSEASON,LASTSEASON FROM PLAYERS ORDER BY ID LIMIT 1000) P1,
      (SELECT ID,FIRSTNAME,LASTNAME,FIRSTSEASON,LASTSEASON FROM PLAYERS ORDER BY ID LIMIT 1000) P2
  WHERE P1.ID<>P2.ID
  ) SUB_Q 
WHERE P1_FIRSTSEASON<P2_FIRSTSEASON 
  AND P1_LASTSEASON>P2_LASTSEASON;

  SELECT P1.*, P2.* 
FROM PLAYERS P1, PLAYERS P2 
WHERE (P1.FIRSTSEASON<P2.FIRSTSEASON AND P1.LASTSEASON>P2.LASTSEASON);

SELECT P1.*, P2.* 
FROM
  (SELECT ID,FIRSTNAME,LASTNAME,FIRSTSEASON,LASTSEASON,WEIGHT,BIRTHDATE FROM PLAYERS ORDER BY ID LIMIT 1000) P1,
  (SELECT ID,FIRSTNAME,LASTNAME,FIRSTSEASON,LASTSEASON,WEIGHT,BIRTHDATE FROM PLAYERS ORDER BY ID LIMIT 1000) P2
WHERE (P1.FIRSTSEASON<P2.FIRSTSEASON AND P1.LASTSEASON>P2.LASTSEASON);

